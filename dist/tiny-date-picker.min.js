!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.TinyDatePicker=e()}(this,function(){"use strict";function t(){var t=new Date;return t.setHours(0,0,0,0),t}function e(t,e){return(t&&t.toDateString())===(e&&e.toDateString())}function n(t,e){return t=new Date(t),t.setDate(t.getDate()+e),t}function a(t,e,n){t=new Date(t);var a=t.getDate(),o=t.getMonth()+e;return t.setDate(1),t.setMonth(n?(12+o)%12:o),t.setDate(a),t.getDate()<a&&t.setDate(0),t}function o(t,e){return t=new Date(t),t.setFullYear(t.getFullYear()+e),t}function r(t,e){return t=new Date(t),t.setFullYear(e),t}function i(t,e){return a(t,e-t.getMonth())}function u(t){return function(e){return"string"==typeof e?t(e):e}}function c(t,e,n){return t<e?e:t>n?n:t}function s(e){e=e||{},e=f(d(),e);var n=u(e.parse);return e.lang=f(Q,e.lang),e.parse=n,e.inRange=l(e),e.min=n(e.min||o(t(),-100)),e.max=n(e.max||o(t(),100)),e.hilightedDate=e.parse(e.hilightedDate),e}function d(){return{lang:Q,mode:"dp-modal",hilightedDate:t(),format:function(t){return t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()},parse:function(e){var n=new Date(e);return isNaN(n)?t():n},dateClass:function(){},inRange:function(){return!0}}}function l(t){var e=t.inRange;return function(n,a){return e(n,a)&&t.min<=n&&t.max>=n}}function f(t,e){e=e||{};for(var n in e)t[n]=e[n];return t}function p(t,e,n){return e.addEventListener(t,n,!0),function(){e.removeEventListener(t,n,!0)}}function h(n){var a=n.opts,o=a.lang,r=n.state,i=o.days,u=a.dayOffset||0,c=r.selectedDate,s=r.hilightedDate,d=s.getMonth(),l=t().getTime();return'<div class="dp-cal"><header class="dp-cal-header"><button tabindex="-1" type="button" class="dp-prev">Prev</button><button tabindex="-1" type="button" class="dp-cal-month">'+o.months[d]+'</button><button tabindex="-1" type="button" class="dp-cal-year">'+s.getFullYear()+'</button><button tabindex="-1" type="button" class="dp-next">Next</button></header><div class="dp-days">'+i.map(function(t,e){return'<span class="dp-col-header">'+i[(e+u)%i.length]+"</span>"}).join("")+F(s,u,function(t){var o=t.getMonth()!==d,r=!a.inRange(t),i=t.getTime()===l,u="dp-day";return u+=o?" dp-edge-day":"",u+=e(t,s)?" dp-current":"",u+=e(t,c)?" dp-selected":"",u+=r?" dp-day-disabled":"",u+=i?" dp-day-today":"",'<button tabindex="-1" type="button" class="'+(u+=" "+a.dateClass(t,n))+'" data-date="'+t.getTime()+'">'+t.getDate()+"</button>"})+'</div><footer class="dp-cal-footer"><button tabindex="-1" type="button" class="dp-today">'+o.today+'</button><button tabindex="-1" type="button" class="dp-clear">'+o.clear+'</button><button tabindex="-1" type="button" class="dp-close">'+o.close+"</button></footer></div>"}function v(t,e){var a=t.keyCode,o=a===U.left?-1:a===U.right?1:a===U.up?-7:a===U.down?7:0;a===U.esc?e.close():o&&(t.preventDefault(),e.setState({hilightedDate:n(e.state.hilightedDate,o)}))}function g(e,n){n.setState({selectedDate:t()})}function m(t,e){e.setState({selectedDate:null})}function b(t,e){e.close()}function y(t,e){e.setState({view:"month"})}function D(t,e){e.setState({view:"year"})}function w(t,e){var n=e.state.hilightedDate;e.setState({hilightedDate:a(n,1)})}function S(t,e){var n=e.state.hilightedDate;e.setState({hilightedDate:a(n,-1)})}function x(t,e){e.setState({selectedDate:new Date(parseInt(t.target.getAttribute("data-date")))})}function F(t,e,n){var a="",o=new Date(t);o.setDate(1),o.setDate(1-o.getDay()+e),e&&o.getDate()===e+1&&o.setDate(e-6);for(var r=0;r<42;++r)a+=n(o),o.setDate(o.getDate()+1);return a}function C(t,e){e.setState({hilightedDate:i(e.state.hilightedDate,parseInt(t.target.getAttribute("data-month"))),view:"day"})}function T(t){var e=t.opts,n=e.lang,a=n.months,o=t.state.hilightedDate,r=o.getMonth();return'<div class="dp-months">'+a.map(function(t,e){var n="dp-month";return'<button tabindex="-1" type="button" class="'+(n+=r===e?" dp-current":"")+'" data-month="'+e+'">'+t+"</button>"}).join("")+"</div>"}function E(t,e){var n=t.keyCode,o=n===U.left?-1:n===U.right?1:n===U.up?-3:n===U.down?3:0;n===U.esc?e.setState({view:"day"}):o&&(t.preventDefault(),e.setState({hilightedDate:a(e.state.hilightedDate,o,!0)}))}function M(t){var e=t.state,n=e.hilightedDate.getFullYear(),a=e.selectedDate.getFullYear();return'<div class="dp-years">'+k(t,function(t){var e="dp-year";return e+=t===n?" dp-current":"",'<button tabindex="-1" type="button" class="'+(e+=t===a?" dp-selected":"")+'" data-year="'+t+'">'+t+"</button>"})+"</div>"}function O(t,e){e.setState({hilightedDate:r(e.state.hilightedDate,parseInt(t.target.getAttribute("data-year"))),view:"day"})}function j(t,e){var n=t.keyCode,a=e.opts,r=n===U.left||n===U.up?1:n===U.right||n===U.down?-1:0;if(n===U.esc)e.setState({view:"day"});else if(r){t.preventDefault();var i=o(e.state.hilightedDate,r);e.setState({hilightedDate:c(i,a.min,a.max)})}}function k(t,e){for(var n="",a=t.opts.max.getFullYear(),o=a;o>=t.opts.min.getFullYear();--o)n+=e(o);return n}function N(t,e){var n=void 0;return function(){clearTimeout(n),n=setTimeout(e,t)}}function H(){}function R(t,e,n){var a,o,r=!1,i={el:void 0,opts:n,shouldFocusOnBlur:!0,shouldFocusOnRender:!0,state:function(){return{get selectedDate(){return o},set selectedDate(t){t&&!n.inRange(t)||(t?(o=new Date(t),i.state.hilightedDate=o):o=t,i.updateInput(o),e("select"),i.close())},view:"day"}}(),adjustPosition:H,containerHTML:'<div class="dp"></div>',attachToDom:function(){document.body.appendChild(i.el)},updateInput:function(e){var a=new Z("change",{bubbles:!0});a.simulated=!0,t.value=e?n.format(e):"",t.dispatchEvent(a)},computeSelectedDate:function(){return n.parse(t.value)},currentView:function(){return et[i.state.view]},open:function(){r||(i.el||(i.el=Y(n,i.containerHTML),V(i)),o=c(i.computeSelectedDate(),n.min,n.max),i.state.hilightedDate=o||n.hilightedDate,i.state.view="day",i.attachToDom(),i.render(),e("open"))},isVisible:function(){return!!i.el&&!!i.el.parentNode},hasFocus:function(){return i.el&&i.el.contains(document.activeElement)},shouldHide:function(){return i.isVisible()},close:function(n){var a=i.el;if(i.isVisible()){if(a){var o=a.parentNode;o&&o.removeChild(a)}r=!0,n&&i.shouldFocusOnBlur&&A(t),setTimeout(function(){r=!1},100),e("close")}},destroy:function(){i.close(),a()},render:function(){if(i.el){var t=i.hasFocus(),e=i.currentView().render(i);e&&(i.el.firstChild.innerHTML=e),i.adjustPosition(),(t||i.shouldFocusOnRender)&&L(i)}},setState:function(t){for(var n in t)i.state[n]=t[n];e("statechange"),i.render()}};return a=P(t,i),i}function Y(t,e){var n=document.createElement("div");return n.className=t.mode,n.innerHTML=e,n}function P(t,e){var n=N(5,function(){e.shouldHide()?e.close():e.open()}),a=[p("blur",t,N(5,function(){e.hasFocus()||e.close(!0)})),p("mousedown",t,function(){t===document.activeElement&&n()}),p("focus",t,n),p("input",t,function(t){var n=e.opts.parse(t.target.value);isNaN(n)||e.setState({hilightedDate:n})})];return function(){a.forEach(function(t){t()})}}function L(t){var e=t.el.querySelector(".dp-current");return e&&e.focus()}function V(t){function e(e){e.target.className.split(" ").forEach(function(n){var a=t.currentView().onClick[n];a&&a(e,t)})}var n=t.el,a=n.querySelector(".dp");p("blur",a,N(10,function(){a.contains(document.activeElement)||t.close(!0)})),p("keydown",n,function(n){n.keyCode===U.enter?e(n):t.currentView().onKeyDown(n,t)}),p("mousedown",a,function(e){e.target.focus(),document.activeElement!==e.target&&(e.preventDefault(),L(t))}),p("click",n,e)}function A(t){t.focus(),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&t.blur()}function I(t,e,n){var a=R(t,e,n);return t.readonly=!0,a.containerHTML+='<a href="#" class="dp-focuser">.</a>',a}function B(t,e,n){var a=R(t,e,n);return a.shouldFocusOnBlur=!1,Object.defineProperty(a,"shouldFocusOnRender",{get:function(){return t!==document.activeElement}}),a.adjustPosition=function(){K(t,a)},a}function K(t,e){var n=t.getBoundingClientRect(),a=window;J(e,n,a),q(e,n,a),e.el.style.visibility=""}function q(t,e,n){var a=t.el,o=n.pageXOffset,r=e.left+o,i=n.innerWidth+o,u=a.offsetWidth,c=r+u,s=i-u,d=c>i&&s>0?s:r;a.style.left=d+"px"}function J(t,e,n){var a=t.el,o=n.pageYOffset,r=o+e.top,i=a.offsetHeight,u=r+e.height+8,c=r-i-8,s=c>0&&u+i>o+n.innerHeight?c:u;a.style.top=s+"px"}function W(t,e,n){var a=R(t,e,n);return a.close=H,a.destroy=H,a.updateInput=H,a.shouldFocusOnRender=!1,a.computeSelectedDate=function(){return n.hilightedDate},a.attachToDom=function(){t.appendChild(a.el)},a.open(),a}function X(t,e,n){return t=t&&t.tagName?t:document.querySelector(t),"dp-modal"===n.mode?I(t,e,n):"dp-below"===n.mode?B(t,e,n):"dp-permanent"===n.mode?W(t,e,n):void 0}function z(){function t(t,e){(n[t]=n[t]||[]).push(e)}function e(e){for(var n in e)t(n,e[n])}var n={};return{on:function(n,a){return a?t(n,a):e(n),this},emit:function(t,e){(n[t]||[]).forEach(function(n){n(t,e)})},off:function(t,e){return t?n[t]=e?(n[t]||[]).filter(function(t){return t!==e}):[]:n={},this}}}function G(t,e){function n(t){a.emit(t,i)}var a=z(),o=s(e),r=X(t,n,o),i={get state(){return r.state},on:a.on,off:a.off,setState:r.setState,open:r.open,close:r.close,destroy:r.destroy};return i}var Q={days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:"Today",clear:"Clear",close:"Close"},U={left:37,up:38,right:39,down:40,enter:13,esc:27},Z=function(){var t=window.CustomEvent;return"function"!=typeof t&&(t=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n},t.prototype=window.Event.prototype),t}(),$={onKeyDown:v,onClick:{"dp-day":x,"dp-next":w,"dp-prev":S,"dp-today":g,"dp-clear":m,"dp-close":b,"dp-cal-month":y,"dp-cal-year":D},render:h},_={onKeyDown:E,onClick:{"dp-month":C},render:T},tt={render:M,onKeyDown:j,onClick:{"dp-year":O}},et={day:$,year:tt,month:_};return G});
//# sourceMappingURL=dist/tiny-date-picker.min.js.map